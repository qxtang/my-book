<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Book - README</title>

  <link rel="stylesheet" href="/my-book/resource/lib/github-markdown.min.css" />
  <link rel="stylesheet" href="/my-book/resource/style.css" />
  <link rel="stylesheet" href="/my-book/resource/lib/highlight/default.min.css" />
  <script src="/my-book/resource/lib/highlight/highlight.min.js"></script>
  <script src="/my-book/resource/lib/jquery.min.js"></script>
  <script src="//unpkg.com/viewerjs@1.10.4/dist/viewer.min.js"></script>
  <script src="//unpkg.com/jquery-viewer@1.0.1/dist/jquery-viewer.min.js"></script>
  <link rel="stylesheet" href="//unpkg.com/viewerjs@1.10.4/dist/viewer.min.css" />

  <link rel="manifest" href="/my-book/manifest.json" />
  <link rel="shortcut icon" type="image/x-icon" href="/my-book/resource/favicon.ico" />
  <link rel="bookmark" type="image/x-icon" href="/my-book/resource/favicon.ico" />
  <link rel="apple-touch-icon" href="/my-book/resource/favicon.ico" />

  <!-- 编译时间：3/27/2022, 3:51:00 PM -->

  <script>
    window.root = '/my-book';
    hljs.highlightAll();
  </script>

  <script src="/my-book/resource/script.js"></script>
</head>

  <body>
    <div class="menu" id="menu"></div>
    <div class="mobile_menu" id="mobile_menu">
      <img src="https://cdn.jsdelivr.net/gh/FortAwesome/font-awesome/svgs/solid/bars.svg" alt="" />
    </div>
    <div class="content markdown-body"><div align="center">
<img src="logo/horizontal.png" alt="connect logo" width="450px">
<p><a href="https://npmjs.org/package/connect"><img src="https://badgen.net/npm/v/connect" alt="NPM Version"></a>
<a href="https://npmjs.org/package/connect"><img src="https://badgen.net/npm/dm/connect" alt="NPM Downloads"></a>
<a href="https://travis-ci.org/senchalabs/connect"><img src="https://badgen.net/travis/senchalabs/connect/master" alt="Build Status"></a>
<a href="https://coveralls.io/r/senchalabs/connect?branch=master"><img src="https://badgen.net/coveralls/c/github/senchalabs/connect/master" alt="Test Coverage"></a></p>
</div>
<p>Connect is an extensible HTTP server framework for <a href="http://nodejs.org">node</a> using &quot;plugins&quot; known as <em>middleware</em>.</p>
<pre><code class="language-js">var connect = require('connect');
var http = require('http');

var app = connect();

// gzip/deflate outgoing responses
var compression = require('compression');
app.use(compression());

// store session state in browser cookie
var cookieSession = require('cookie-session');
app.use(cookieSession({
    keys: ['secret1', 'secret2']
}));

// parse urlencoded request bodies into req.body
var bodyParser = require('body-parser');
app.use(bodyParser.urlencoded({extended: false}));

// respond to all requests
app.use(function(req, res){
  res.end('Hello from Connect!\n');
});

//create node.js http server and listen on port
http.createServer(app).listen(3000);
</code></pre>
<h2>Getting Started</h2>
<p>Connect is a simple framework to glue together various &quot;middleware&quot; to handle requests.</p>
<h3>Install Connect</h3>
<pre><code class="language-sh">$ npm install connect
</code></pre>
<h3>Create an app</h3>
<p>The main component is a Connect &quot;app&quot;. This will store all the middleware
added and is, itself, a function.</p>
<pre><code class="language-js">var app = connect();
</code></pre>
<h3>Use middleware</h3>
<p>The core of Connect is &quot;using&quot; middleware. Middleware are added as a &quot;stack&quot;
where incoming requests will execute each middleware one-by-one until a middleware
does not call <code>next()</code> within it.</p>
<pre><code class="language-js">app.use(function middleware1(req, res, next) {
  // middleware 1
  next();
});
app.use(function middleware2(req, res, next) {
  // middleware 2
  next();
});
</code></pre>
<h3>Mount middleware</h3>
<p>The <code>.use()</code> method also takes an optional path string that is matched against
the beginning of the incoming request URL. This allows for basic routing.</p>
<pre><code class="language-js">app.use('/foo', function fooMiddleware(req, res, next) {
  // req.url starts with &quot;/foo&quot;
  next();
});
app.use('/bar', function barMiddleware(req, res, next) {
  // req.url starts with &quot;/bar&quot;
  next();
});
</code></pre>
<h3>Error middleware</h3>
<p>There are special cases of &quot;error-handling&quot; middleware. There are middleware
where the function takes exactly 4 arguments. When a middleware passes an error
to <code>next</code>, the app will proceed to look for the error middleware that was declared
after that middleware and invoke it, skipping any error middleware above that
middleware and any non-error middleware below.</p>
<pre><code class="language-js">// regular middleware
app.use(function (req, res, next) {
  // i had an error
  next(new Error('boom!'));
});

// error middleware for errors that occurred in middleware
// declared before this
app.use(function onerror(err, req, res, next) {
  // an error occurred!
});
</code></pre>
<h3>Create a server from the app</h3>
<p>The last step is to actually use the Connect app in a server. The <code>.listen()</code> method
is a convenience to start a HTTP server (and is identical to the <code>http.Server</code>'s <code>listen</code>
method in the version of Node.js you are running).</p>
<pre><code class="language-js">var server = app.listen(port);
</code></pre>
<p>The app itself is really just a function with three arguments, so it can also be handed
to <code>.createServer()</code> in Node.js.</p>
<pre><code class="language-js">var server = http.createServer(app);
</code></pre>
<h2>Middleware</h2>
<p>These middleware and libraries are officially supported by the Connect/Express team:</p>
<ul>
<li><a href="https://www.npmjs.com/package/body-parser">body-parser</a> - previous <code>bodyParser</code>, <code>json</code>, and <code>urlencoded</code>. You may also be interested in:
<ul>
<li><a href="https://www.npmjs.com/package/body">body</a></li>
<li><a href="https://www.npmjs.com/package/co-body">co-body</a></li>
<li><a href="https://www.npmjs.com/package/raw-body">raw-body</a></li>
</ul>
</li>
<li><a href="https://www.npmjs.com/package/compression">compression</a> - previously <code>compress</code></li>
<li><a href="https://www.npmjs.com/package/connect-timeout">connect-timeout</a> - previously <code>timeout</code></li>
<li><a href="https://www.npmjs.com/package/cookie-parser">cookie-parser</a> - previously <code>cookieParser</code></li>
<li><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> - previously <code>cookieSession</code></li>
<li><a href="https://www.npmjs.com/package/csurf">csurf</a> - previously <code>csrf</code></li>
<li><a href="https://www.npmjs.com/package/errorhandler">errorhandler</a> - previously <code>error-handler</code></li>
<li><a href="https://www.npmjs.com/package/express-session">express-session</a> - previously <code>session</code></li>
<li><a href="https://www.npmjs.com/package/method-override">method-override</a> - previously <code>method-override</code></li>
<li><a href="https://www.npmjs.com/package/morgan">morgan</a> - previously <code>logger</code></li>
<li><a href="https://www.npmjs.com/package/response-time">response-time</a> - previously <code>response-time</code></li>
<li><a href="https://www.npmjs.com/package/serve-favicon">serve-favicon</a> - previously <code>favicon</code></li>
<li><a href="https://www.npmjs.com/package/serve-index">serve-index</a> - previously <code>directory</code></li>
<li><a href="https://www.npmjs.com/package/serve-static">serve-static</a> - previously <code>static</code></li>
<li><a href="https://www.npmjs.com/package/vhost">vhost</a> - previously <code>vhost</code></li>
</ul>
<p>Most of these are exact ports of their Connect 2.x equivalents. The primary exception is <code>cookie-session</code>.</p>
<p>Some middleware previously included with Connect are no longer supported by the Connect/Express team, are replaced by an alternative module, or should be superseded by a better module. Use one of these alternatives instead:</p>
<ul>
<li><code>cookieParser</code>
<ul>
<li><a href="https://www.npmjs.com/package/cookies">cookies</a> and <a href="https://www.npmjs.com/package/keygrip">keygrip</a></li>
</ul>
</li>
<li><code>limit</code>
<ul>
<li><a href="https://www.npmjs.com/package/raw-body">raw-body</a></li>
</ul>
</li>
<li><code>multipart</code>
<ul>
<li><a href="https://www.npmjs.com/package/connect-multiparty">connect-multiparty</a></li>
<li><a href="https://www.npmjs.com/package/connect-busboy">connect-busboy</a></li>
</ul>
</li>
<li><code>query</code>
<ul>
<li><a href="https://www.npmjs.com/package/qs">qs</a></li>
</ul>
</li>
<li><code>staticCache</code>
<ul>
<li><a href="https://www.npmjs.com/package/st">st</a></li>
<li><a href="https://www.npmjs.com/package/connect-static">connect-static</a></li>
</ul>
</li>
</ul>
<p>Checkout <a href="https://github.com/Raynos/http-framework/wiki/Modules">http-framework</a> for many other compatible middleware!</p>
<h2>API</h2>
<p>The Connect API is very minimalist, enough to create an app and add a chain
of middleware.</p>
<p>When the <code>connect</code> module is required, a function is returned that will construct
a new app when called.</p>
<pre><code class="language-js">// require module
var connect = require('connect')

// create app
var app = connect()
</code></pre>
<h3>app(req, res[, next])</h3>
<p>The <code>app</code> itself is a function. This is just an alias to <code>app.handle</code>.</p>
<h3>app.handle(req, res[, out])</h3>
<p>Calling the function will run the middleware stack against the given Node.js
http request (<code>req</code>) and response (<code>res</code>) objects. An optional function <code>out</code>
can be provided that will be called if the request (or error) was not handled
by the middleware stack.</p>
<h3>app.listen([...])</h3>
<p>Start the app listening for requests. This method will internally create a Node.js
HTTP server and call <code>.listen()</code> on it.</p>
<p>This is an alias to the <code>server.listen()</code> method in the version of Node.js running,
so consult the Node.js documentation for all the different variations. The most
common signature is <a href="https://nodejs.org/dist/latest-v6.x/docs/api/http.html#http_server_listen_port_hostname_backlog_callback"><code>app.listen(port)</code></a>.</p>
<h3>app.use(fn)</h3>
<p>Use a function on the app, where the function represents a middleware. The function
will be invoked for every request in the order that <code>app.use</code> is called. The function
is called with three arguments:</p>
<pre><code class="language-js">app.use(function (req, res, next) {
  // req is the Node.js http request object
  // res is the Node.js http response object
  // next is a function to call to invoke the next middleware
})
</code></pre>
<p>In addition to a plan function, the <code>fn</code> argument can also be a Node.js HTTP server
instance or another Connect app instance.</p>
<h3>app.use(route, fn)</h3>
<p>Use a function on the app, where the function represents a middleware. The function
will be invoked for every request in which the URL (<code>req.url</code> property) starts with
the given <code>route</code> string in the order that <code>app.use</code> is called. The function is
called with three arguments:</p>
<pre><code class="language-js">app.use('/foo', function (req, res, next) {
  // req is the Node.js http request object
  // res is the Node.js http response object
  // next is a function to call to invoke the next middleware
})
</code></pre>
<p>In addition to a plan function, the <code>fn</code> argument can also be a Node.js HTTP server
instance or another Connect app instance.</p>
<p>The <code>route</code> is always terminated at a path separator (<code>/</code>) or a dot (<code>.</code>) character.
This means the given routes <code>/foo/</code> and <code>/foo</code> are the same and both will match requests
with the URLs <code>/foo</code>, <code>/foo/</code>, <code>/foo/bar</code>, and <code>/foo.bar</code>, but not match a request with
the URL <code>/foobar</code>.</p>
<p>The <code>route</code> is matched in a case-insensitive manor.</p>
<p>In order to make middleware easier to write to be agnostic of the <code>route</code>, when the
<code>fn</code> is invoked, the <code>req.url</code> will be altered to remove the <code>route</code> part (and the
original will be available as <code>req.originalUrl</code>). For example, if <code>fn</code> is used at the
route <code>/foo</code>, the request for <code>/foo/bar</code> will invoke <code>fn</code> with <code>req.url === '/bar'</code>
and <code>req.originalUrl === '/foo/bar'</code>.</p>
<h2>Running Tests</h2>
<pre><code class="language-bash">npm install
npm test
</code></pre>
<h2>People</h2>
<p>The Connect project would not be the same without all the people involved.</p>
<p>The original author of Connect is <a href="https://github.com/tj">TJ Holowaychuk</a></p>
<p>The current lead maintainer is <a href="https://github.com/dougwilson">Douglas Christopher Wilson</a></p>
<p><a href="https://github.com/senchalabs/connect/graphs/contributors">List of all contributors</a></p>
<h2>Node Compatibility</h2>
<ul>
<li>Connect <code>&lt; 1.x</code> - node <code>0.2</code></li>
<li>Connect <code>1.x</code> - node <code>0.4</code></li>
<li>Connect <code>&lt; 2.8</code> - node <code>0.6</code></li>
<li>Connect <code>&gt;= 2.8 &lt; 3</code> - node <code>0.8</code></li>
<li>Connect <code>&gt;= 3</code> - node <code>0.10</code>, <code>0.12</code>, <code>4.x</code>, <code>5.x</code>, <code>6.x</code>, <code>7.x</code>, <code>8.x</code>, <code>9.x</code>, <code>10.x</code>, <code>11.x</code>, <code>12.x</code>; io.js <code>1.x</code>, <code>2.x</code>, <code>3.x</code></li>
</ul>
<h2>License</h2>
<p><a href="LICENSE">MIT</a></p>
</div>
  </body>
</html>

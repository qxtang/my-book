- 参考：  
  [https://juejin.cn/post/6844904046411644941](https://juejin.cn/post/6844904046411644941)  
  [https://zhuanlan.zhihu.com/p/149063367](https://zhuanlan.zhihu.com/p/149063367)

# 浏览器架构（以 chrome 为例）

![](../../resource/%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9B%E7%A8%8B.jpeg)

## 各个进程具体负责的工作内容

- Browser：负责浏览器的“Chrome”部分， 包括导航栏，书签， 前进和后退按钮。同时这个进程还会控制那些我们看不见的部分，包括网络请求的发送以及文件的读写。
- Renderer：负责 tab 内和网页展示相关的所有工作。Chrome 会尽可能为每一个 tab 甚至是页面里面的每一个 iframe 都分配一个单独的渲染进程
- Plugin：控制网页使用的所有插件，例如 flash 插件
- GPU：负责独立于其它进程的 GPU 任务。它之所以被独立为一个进程是因为它要处理来自于不同 tab 的渲染请求并把它在同一个界面上画出来

## 多进程架构

为了节省内存，Chrome 会限制被启动的进程数目，  
当进程数达到一定的界限后，Chrome 会将访问同一个网站的 tab 都放在一个进程里面跑，  
每一个 tab 页面可以看作是浏览器内核进程，然后这个进程是多线程的，它有几大类子线程：

- GUI 线程
- JS 引擎线程
- 事件触发线程
- 定时器线程
- 网络请求线程

**其中 GUI 线程和 JS 引擎线程是互斥的：**

由于 JavaScript 是可操纵 DOM 的，如果在修改这些元素属性同时渲染界面（即 JavaScript 线程和 UI 线程同时运行），那么渲染线程前后获得的元素数据就可能不一致

### 好处

- 提供安全性和沙盒性，当其中一个 tab 的崩溃时，你可以随时关闭这个 tab 并且其他 tab 不受到影响

### 坏处

- 内存消耗大

## 网站隔离功能

- 会为网站内不同站点的 iframe 分配一个独立的渲染进程
- 由来：如果一个 tab 只有一个进程的话不同站点的 iframe 都会跑在这个进程里面，这也意味着它们会共享内存，这就有可能会破坏同源策略
